<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Encuesta: Transporte Público (Estudiantes)</title>
  <style>
    :root{
      --bg:#f6f8fb;
      --card:#ffffff;
      --accent:#2563eb;
      --muted:#6b7280;
      --success:#10b981;
      --shadow: 0 8px 24px rgba(16,24,40,0.06);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#f6f8fb 0%, #eef2ff 100%);color:#0f172a;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
    .container{width:100%;max-width:900px}
    .card{background:var(--card);border-radius:14px;padding:26px;box-shadow:var(--shadow)}
    header{display:flex;align-items:center;gap:16px;margin-bottom:12px}
    .logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#7c3aed);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:18px}
    h1{font-size:20px;margin:0}
    p.lead{margin:4px 0 18px;color:var(--muted)}
    form{display:flex;flex-direction:column;gap:18px}
    .question{padding:14px;border-radius:10px;border:1px solid #eef2f8}
    .q-title{display:flex;align-items:center;gap:10px;margin-bottom:8px}
    .q-title b{font-size:14px}
    .options{display:flex;flex-direction:column;gap:8px}
    label.option{display:flex;align-items:center;gap:10px;cursor:pointer;padding:8px;border-radius:8px}
    input[type="radio"], input[type="checkbox"]{width:18px;height:18px}
    .meta{display:flex;justify-content:space-between;align-items:center;gap:16px}
    .progress{height:10px;background:#eef2ff;border-radius:999px;overflow:hidden;flex:1}
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#7c3aed);width:0%}
    .footer{display:flex;gap:12px;align-items:center}
    button.primary{background:var(--accent);color:white;padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:600}
    button.ghost{background:transparent;border:1px solid #e6eefc;padding:10px 14px;border-radius:10px;cursor:pointer}
    .results{margin-top:16px;padding:14px;background:#f8fafc;border-radius:8px;border:1px dashed #e6eefc}
    pre{white-space:pre-wrap;word-break:break-word}
    @media (max-width:640px){.meta{flex-direction:column;align-items:flex-start}.footer{flex-direction:column;align-items:stretch}}
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <header>
        <div class="logo">TP</div>
        <div>
          <h1>Encuesta: Transporte público (Estudiantes)</h1>
          <p class="lead">10 preguntas — Responde seleccionando la opción que mejor describa tu experiencia.</p>
        </div>
      </header>

      <form id="survey" autocomplete="off">

        <!-- 1 -->
        <div class="question" data-q="1">
          <div class="q-title"><b>1. ¿Con qué frecuencia utilizas el transporte público?</b></div>
          <div class="options">
            <label class="option"><input type="radio" name="q1" value="Todos los días" required> Todos los días</label>
            <label class="option"><input type="radio" name="q1" value="Varias veces por semana"> Varias veces por semana</label>
            <label class="option"><input type="radio" name="q1" value="Una vez por semana"> Una vez por semana</label>
            <label class="option"><input type="radio" name="q1" value="Casi nunca"> Casi nunca</label>
            <label class="option"><input type="radio" name="q1" value="Nunca"> Nunca</label>
          </div>
        </div>

        <!-- 2 -->
        <div class="question" data-q="2">
          <div class="q-title"><b>2. ¿Qué tipo de transporte público usas con más frecuencia?</b></div>
          <div class="options">
            <label class="option"><input type="radio" name="q2" value="Bus urbano" required> Bus urbano</label>
            <label class="option"><input type="radio" name="q2" value="Metro o tranvía"> Metro o tranvía</label>
            <label class="option"><input type="radio" name="q2" value="Mototaxi"> Mototaxi</label>
            <label class="option"><input type="radio" name="q2" value="Taxi o plataformas"> Taxi o plataformas (Uber, Didi, etc.)</label>
            <label class="option"><input type="radio" name="q2" value="Otro medio"> Otro medio</label>
          </div>
        </div>

        <!-- 3 -->
        <div class="question" data-q="3">
          <div class="q-title"><b>3. ¿Cuánto tiempo promedio tardas en llegar a tu institución educativa?</b></div>
          <div class="options">
            <label class="option"><input type="radio" name="q3" value="Menos de 15 minutos" required> Menos de 15 minutos</label>
            <label class="option"><input type="radio" name="q3" value="15 a 30 minutos"> 15 a 30 minutos</label>
            <label class="option"><input type="radio" name="q3" value="31 a 60 minutos"> 31 a 60 minutos</label>
            <label class="option"><input type="radio" name="q3" value="Más de una hora"> Más de una hora</label>
          </div>
        </div>

        <!-- 4 -->
        <div class="question" data-q="4">
          <div class="q-title"><b>4. ¿Cuánto dinero gastas en transporte público diariamente?</b></div>
          <div class="options">
            <label class="option"><input type="radio" name="q4" value="Menos de $3.000" required> Menos de $3.000</label>
            <label class="option"><input type="radio" name="q4" value="Entre $3.000 y $6.000"> Entre $3.000 y $6.000</label>
            <label class="option"><input type="radio" name="q4" value="Entre $6.001 y $10.000"> Entre $6.001 y $10.000</label>
            <label class="option"><input type="radio" name="q4" value="Más de $10.000"> Más de $10.000</label>
          </div>
        </div>

        <!-- 5 -->
        <div class="question" data-q="5">
          <div class="q-title"><b>5. ¿Qué tan satisfecho(a) estás con el servicio de transporte público?</b></div>
          <div class="options">
            <label class="option"><input type="radio" name="q5" value="Muy satisfecho(a)" required> Muy satisfecho(a)</label>
            <label class="option"><input type="radio" name="q5" value="Satisfecho(a)"> Satisfecho(a)</label>
            <label class="option"><input type="radio" name="q5" value="Neutral"> Neutral</label>
            <label class="option"><input type="radio" name="q5" value="Insatisfecho(a)"> Insatisfecho(a)</label>
            <label class="option"><input type="radio" name="q5" value="Muy insatisfecho(a)"> Muy insatisfecho(a)</label>
          </div>
        </div>

        <!-- 6 -->
        <div class="question" data-q="6">
          <div class="q-title"><b>6. ¿Qué aspectos consideras más problemáticos del transporte público? (Selecciona máximo 2)</b></div>
          <div class="options">
            <label class="option"><input type="checkbox" name="q6" value="Demoras o falta de puntualidad"> Demoras o falta de puntualidad</label>
            <label class="option"><input type="checkbox" name="q6" value="Inseguridad"> Inseguridad</label>
            <label class="option"><input type="checkbox" name="q6" value="Mal estado de los vehículos"> Mal estado de los vehículos</label>
            <label class="option"><input type="checkbox" name="q6" value="Sobrecupo o falta de espacio"> Sobrecupo o falta de espacio</label>
            <label class="option"><input type="checkbox" name="q6" value="Mal servicio del conductor"> Mal servicio del conductor</label>
            <label class="option"><input type="checkbox" name="q6" value="Precio elevado"> Precio elevado</label>
          </div>
          <small style="color:var(--muted);">Máximo 2 opciones.</small>
        </div>

        <!-- 7 -->
        <div class="question" data-q="7">
          <div class="q-title"><b>7. ¿Qué tan seguro(a) te sientes al usar el transporte público?</b></div>
          <div class="options">
            <label class="option"><input type="radio" name="q7" value="Muy seguro(a)" required> Muy seguro(a)</label>
            <label class="option"><input type="radio" name="q7" value="Algo seguro(a)"> Algo seguro(a)</label>
            <label class="option"><input type="radio" name="q7" value="Poco seguro(a)"> Poco seguro(a)</label>
            <label class="option"><input type="radio" name="q7" value="Nada seguro(a)"> Nada seguro(a)</label>
          </div>
        </div>

        <!-- 8 -->
        <div class="question" data-q="8">
          <div class="q-title"><b>8. ¿Qué factor influye más en tu elección de transporte?</b></div>
          <div class="options">
            <label class="option"><input type="radio" name="q8" value="Precio" required> Precio</label>
            <label class="option"><input type="radio" name="q8" value="Tiempo de viaje"> Tiempo de viaje</label>
            <label class="option"><input type="radio" name="q8" value="Comodidad"> Comodidad</label>
            <label class="option"><input type="radio" name="q8" value="Seguridad"> Seguridad</label>
            <label class="option"><input type="radio" name="q8" value="Disponibilidad"> Disponibilidad</label>
          </div>
        </div>

        <!-- 9 -->
        <div class="question" data-q="9">
          <div class="q-title"><b>9. ¿Cómo calificas la limpieza y mantenimiento de los vehículos de transporte público?</b></div>
          <div class="options">
            <label class="option"><input type="radio" name="q9" value="Excelente" required> Excelente</label>
            <label class="option"><input type="radio" name="q9" value="Bueno"> Bueno</label>
            <label class="option"><input type="radio" name="q9" value="Regular"> Regular</label>
            <label class="option"><input type="radio" name="q9" value="Malo"> Malo</label>
            <label class="option"><input type="radio" name="q9" value="Muy malo"> Muy malo</label>
          </div>
        </div>

        <!-- 10 -->
        <div class="question" data-q="10">
          <div class="q-title"><b>10. Si tuvieras la opción de otro medio de transporte, ¿seguirías usando el transporte público?</b></div>
          <div class="options">
            <label class="option"><input type="radio" name="q10" value="Sí, siempre" required> Sí, siempre</label>
            <label class="option"><input type="radio" name="q10" value="Sí, pero con mejoras"> Sí, pero con mejoras</label>
            <label class="option"><input type="radio" name="q10" value="Solo en algunos casos"> Solo en algunos casos</label>
            <label class="option"><input type="radio" name="q10" value="No, preferiría otro medio"> No, preferiría otro medio</label>
          </div>
        </div>

        <div class="meta">
          <div style="display:flex;align-items:center;gap:12px;width:100%">
            <div class="progress" aria-hidden><i id="progressBar"></i></div>
            <small id="progressText" style="min-width:120px;color:var(--muted)">0/10 completadas</small>
          </div>
        </div>

        <div class="footer">
          <button type="submit" class="primary">Enviar encuesta</button>
          <button type="button" id="resetBtn" class="ghost">Limpiar respuestas</button>
          <div style="margin-left:auto;display:flex;gap:8px">
            <button type="button" id="exportJSON" class="ghost">Exportar (JSON)</button>
            <button type="button" id="exportCSV" class="ghost">Exportar (CSV)</button>
          </div>
        </div>

      </form>

      <div id="result" class="results" style="display:none">
        <strong>Resumen de la respuesta:</strong>
        <div id="out" style="margin-top:8px"></div>
      </div>

    </div>
  </div>

  <script>
    (function(){
      const form = document.getElementById('survey');
      const progress = document.getElementById('progressBar');
      const progressText = document.getElementById('progressText');
      const resultBox = document.getElementById('result');
      const out = document.getElementById('out');
      const resetBtn = document.getElementById('resetBtn');
      const exportJSON = document.getElementById('exportJSON');
      const exportCSV = document.getElementById('exportCSV');

      const totalQuestions = 10;

      // update progress
      function updateProgress(){
        let answered = 0;
        for(let i=1;i<=totalQuestions;i++){
          const name = 'q'+i;
          const els = form.elements[name];
          if(!els) continue;
          if(els[0].type === 'radio'){
            for(const r of els) if(r.checked){ answered++; break }
          } else if(els[0].type === 'checkbox'){
            const checked = Array.from(els).filter(ch => ch.checked).length;
            if(checked>0) answered++;
          }
        }
        const pct = Math.round((answered/totalQuestions)*100);
        progress.style.width = pct + '%';
        progressText.textContent = answered + '/' + totalQuestions + ' completadas';
      }

      // limit checkboxes q6 to max 2
      const q6checks = Array.from(document.querySelectorAll('input[name="q6"]'));
      q6checks.forEach(ch => ch.addEventListener('change', ()=>{
        const checked = q6checks.filter(c=>c.checked);
        if(checked.length > 2){
          // uncheck the last one changed (this event's target is ch)
          // to give user feedback, revert and flash
          event.target.checked = false;
          alert('Puedes seleccionar máximo 2 opciones en esta pregunta.');
        }
        updateProgress();
      }));

      // attach listeners to radios
      form.querySelectorAll('input[type="radio"]').forEach(r => r.addEventListener('change', updateProgress));

      // initial progress
      updateProgress();

      // submit handler
      form.addEventListener('submit', function(ev){
        ev.preventDefault();
        // simple validation: ensure all radio groups have a selection
        for(let i=1;i<=totalQuestions;i++){
          const name = 'q'+i;
          const els = form.elements[name];
          if(!els) continue;
          if(els[0].type === 'radio'){
            if(!Array.from(els).some(r=>r.checked)){
              alert('Por favor responde la pregunta ' + i);
              return;
            }
          }
          if(els[0].type === 'checkbox'){
            // ok if none? previously we counted as answered only if >0; but require at least 1
            if(!Array.from(els).some(c=>c.checked)){
              alert('Por favor selecciona al menos una opción en la pregunta ' + i);
              return;
            }
          }
        }

        // gather responses
        const data = {};
        for(let i=1;i<=totalQuestions;i++){
          const name = 'q'+i;
          const els = form.elements[name];
          if(!els) continue;
          if(els[0].type === 'radio'){
            const sel = Array.from(els).find(r=>r.checked);
            data[name] = sel ? sel.value : null;
          } else if(els[0].type === 'checkbox'){
            data[name] = Array.from(els).filter(c=>c.checked).map(c=>c.value);
          }
        }

        // show summary
        out.innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
        resultBox.style.display = 'block';
        // scroll to results
        resultBox.scrollIntoView({behavior:'smooth'});
      });

      // reset
      resetBtn.addEventListener('click', ()=>{ form.reset(); updateProgress(); resultBox.style.display='none'; out.innerHTML=''; });

      // exports
      function download(filename, content){
        const blob = new Blob([content], {type:'application/octet-stream'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = filename; document.body.appendChild(a); a.click(); a.remove();
        URL.revokeObjectURL(url);
      }

      exportJSON.addEventListener('click', ()=>{
        // gather current answers (partial allowed)
        const data = {};
        for(let i=1;i<=totalQuestions;i++){
          const name = 'q'+i;
          const els = form.elements[name];
          if(!els) continue;
          if(els[0].type === 'radio'){
            const sel = Array.from(els).find(r=>r.checked);
            data[name] = sel ? sel.value : null;
          } else if(els[0].type === 'checkbox'){
            data[name] = Array.from(els).filter(c=>c.checked).map(c=>c.value);
          }
        }
        download('respuestas_encuesta_transporte.json', JSON.stringify(data, null, 2));
      });

      exportCSV.addEventListener('click', ()=>{
        const headers = [];
        const row = [];
        for(let i=1;i<=totalQuestions;i++){
          const name = 'q'+i;
          headers.push('Pregunta ' + i);
          const els = form.elements[name];
          if(!els) { row.push(''); continue; }
          if(els[0].type === 'radio'){
            const sel = Array.from(els).find(r=>r.checked);
            row.push(sel ? ('"'+sel.value.replace(/"/g,'""')+'"') : '');
          } else if(els[0].type === 'checkbox'){
            const arr = Array.from(els).filter(c=>c.checked).map(c=>'"'+c.value.replace(/"/g,'""')+'"');
            row.push(arr.join(';'));
          }
        }
        const csv = headers.join(',') + '\n' + row.join(',') + '\n';
        download('respuestas_encuesta_transporte.csv', csv);
      });

    })();
  </script>
</body>
</html>
